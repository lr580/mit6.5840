[mit6.5840网址](http://nil.csail.mit.edu/6.5840/2025/)

# 实现过程

## Lab1

### 环境准备

根据 [lab1](http://nil.csail.mit.edu/6.5840/2025/labs/lab-mr.html) 的第一句话，克隆远程仓库获取源码

```sh
git clone git://g.csail.mit.edu/6.5840-golabs-2025 6.5840
```

在 [setup go](http://nil.csail.mit.edu/6.5840/2025/labs/go.html)，需求 Go 1.22 版本，使用 `go version` 可查询版本。

需求使用 Linux，这里我使用 WSL2。按照指示检查运行：

> ```go
> cd src/main
> go build -buildmode=plugin ../mrapps/wc.go
> rm mr-out*
> go run mrsequential.go wc.so pg*.txt
> more mr-out-0
> ```

其中，build的构建模式为plugin，它生成`.so` 文件，即 `wc.go`，项目结构 `src/`

- `mrapps/` 是 map-reduce 实际应用例子，如 `wc.go`，看到它定义了 Map 和 Reduce 函数。其中 Map 函数的第一个参数在例子中忽略，只看第二个参数(文件内容)，它把不是 Letter(a-zA-Z) 的连续内容作为分隔符，然后分割后的单词数组返回 (`mr/KeyValue`) (没有做合并)。Reduce 函数，传入 key 值和 values 列表，values 长度转字符串作为该 key 的合并结果。
- 对 `main/mrsequential.go`，传入 `.so` 执行，选择文件名执行。它的 `loadPlugin` 函数，导入插件，查找 Map, Reduce 函数，并返回。对每一份文件，把读取的文件内容和文件名传入 map 函数，得到 key-value 列表；所有文件的合并到一个列表里。(实际上应该分快存储)，然后进行排序，创建输出文件。排序后 key 相同的全部 value 集合并到一个 string[] 里。把这个 slice 传给 reduce 函数，然后输出结果到文件。

# 过程记录

- 2025/9/29 2h 阅读Lab1代码，学习go语法